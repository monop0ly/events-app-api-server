function cov_1vob0z37fp(){var path="/home/user201/sample-master-2021/api-server/src/services/class.firestore.database.service.js";var hash="e42a18b1a872c8a2798a4ee3011b84bbe48b423f";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/user201/sample-master-2021/api-server/src/services/class.firestore.database.service.js",statementMap:{"0":{start:{line:3,column:18},end:{line:3,column:62}},"1":{start:{line:7,column:8},end:{line:12,column:10}},"2":{start:{line:20,column:20},end:{line:20,column:34}},"3":{start:{line:21,column:8},end:{line:38,column:9}},"4":{start:{line:22,column:29},end:{line:22,column:104}},"5":{start:{line:23,column:12},end:{line:33,column:13}},"6":{start:{line:24,column:16},end:{line:32,column:25}},"7":{start:{line:27,column:34},end:{line:27,column:44}},"8":{start:{line:29,column:20},end:{line:29,column:38}},"9":{start:{line:31,column:20},end:{line:31,column:43}},"10":{start:{line:34,column:12},end:{line:34,column:23}},"11":{start:{line:36,column:12},end:{line:36,column:58}},"12":{start:{line:37,column:12},end:{line:37,column:63}},"13":{start:{line:49,column:8},end:{line:49,column:24}},"14":{start:{line:50,column:8},end:{line:50,column:27}},"15":{start:{line:51,column:8},end:{line:75,column:9}},"16":{start:{line:53,column:12},end:{line:57,column:13}},"17":{start:{line:54,column:16},end:{line:54,column:85}},"18":{start:{line:56,column:16},end:{line:56,column:54}},"19":{start:{line:58,column:12},end:{line:58,column:61}},"20":{start:{line:59,column:29},end:{line:59,column:81}},"21":{start:{line:61,column:12},end:{line:71,column:13}},"22":{start:{line:62,column:16},end:{line:66,column:17}},"23":{start:{line:63,column:20},end:{line:63,column:50}},"24":{start:{line:65,column:20},end:{line:65,column:82}},"25":{start:{line:69,column:16},end:{line:69,column:39}},"26":{start:{line:70,column:16},end:{line:70,column:29}},"27":{start:{line:73,column:12},end:{line:73,column:57}},"28":{start:{line:74,column:12},end:{line:74,column:62}},"29":{start:{line:84,column:8},end:{line:96,column:9}},"30":{start:{line:85,column:29},end:{line:85,column:84}},"31":{start:{line:86,column:12},end:{line:92,column:13}},"32":{start:{line:87,column:28},end:{line:87,column:43}},"33":{start:{line:88,column:16},end:{line:88,column:57}},"34":{start:{line:89,column:16},end:{line:89,column:36}},"35":{start:{line:91,column:16},end:{line:91,column:36}},"36":{start:{line:94,column:12},end:{line:94,column:61}},"37":{start:{line:95,column:12},end:{line:95,column:66}},"38":{start:{line:105,column:20},end:{line:105,column:34}},"39":{start:{line:106,column:8},end:{line:123,column:9}},"40":{start:{line:107,column:29},end:{line:107,column:104}},"41":{start:{line:108,column:12},end:{line:118,column:13}},"42":{start:{line:109,column:16},end:{line:117,column:25}},"43":{start:{line:112,column:34},end:{line:112,column:44}},"44":{start:{line:114,column:20},end:{line:114,column:38}},"45":{start:{line:116,column:20},end:{line:116,column:43}},"46":{start:{line:119,column:12},end:{line:119,column:23}},"47":{start:{line:121,column:12},end:{line:121,column:65}},"48":{start:{line:122,column:12},end:{line:122,column:70}},"49":{start:{line:134,column:8},end:{line:149,column:9}},"50":{start:{line:135,column:12},end:{line:138,column:13}},"51":{start:{line:136,column:16},end:{line:136,column:54}},"52":{start:{line:137,column:16},end:{line:137,column:65}},"53":{start:{line:139,column:29},end:{line:139,column:92}},"54":{start:{line:140,column:12},end:{line:140,column:67}},"55":{start:{line:141,column:12},end:{line:145,column:13}},"56":{start:{line:142,column:16},end:{line:142,column:40}},"57":{start:{line:144,column:16},end:{line:144,column:36}},"58":{start:{line:147,column:12},end:{line:147,column:60}},"59":{start:{line:148,column:12},end:{line:148,column:65}},"60":{start:{line:153,column:8},end:{line:159,column:9}},"61":{start:{line:154,column:29},end:{line:154,column:87}},"62":{start:{line:155,column:12},end:{line:155,column:72}},"63":{start:{line:157,column:12},end:{line:157,column:60}},"64":{start:{line:158,column:12},end:{line:158,column:65}},"65":{start:{line:162,column:46},end:{line:162,column:58}},"66":{start:{line:163,column:29},end:{line:163,column:41}},"67":{start:{line:166,column:8},end:{line:192,column:9}},"68":{start:{line:168,column:12},end:{line:189,column:52}},"69":{start:{line:170,column:31},end:{line:170,column:46}},"70":{start:{line:172,column:20},end:{line:174,column:21}},"71":{start:{line:173,column:24},end:{line:173,column:37}},"72":{start:{line:176,column:20},end:{line:181,column:21}},"73":{start:{line:177,column:24},end:{line:177,column:35}},"74":{start:{line:180,column:24},end:{line:180,column:35}},"75":{start:{line:183,column:20},end:{line:187,column:23}},"76":{start:{line:186,column:24},end:{line:186,column:48}},"77":{start:{line:189,column:32},end:{line:189,column:48}},"78":{start:{line:191,column:12},end:{line:191,column:36}},"79":{start:{line:196,column:8},end:{line:196,column:46}},"80":{start:{line:200,column:8},end:{line:200,column:51}},"81":{start:{line:204,column:26},end:{line:204,column:46}},"82":{start:{line:205,column:8},end:{line:205,column:99}},"83":{start:{line:209,column:26},end:{line:209,column:41}},"84":{start:{line:210,column:8},end:{line:210,column:99}},"85":{start:{line:214,column:0},end:{line:214,column:42}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:6,column:4},end:{line:6,column:5}},loc:{start:{line:6,column:18},end:{line:13,column:5}},line:6},"1":{name:"(anonymous_1)",decl:{start:{line:19,column:4},end:{line:19,column:5}},loc:{start:{line:19,column:21},end:{line:39,column:5}},line:19},"2":{name:"(anonymous_2)",decl:{start:{line:24,column:38},end:{line:24,column:39}},loc:{start:{line:24,column:45},end:{line:32,column:17}},line:24},"3":{name:"(anonymous_3)",decl:{start:{line:48,column:4},end:{line:48,column:5}},loc:{start:{line:48,column:46},end:{line:76,column:5}},line:48},"4":{name:"(anonymous_4)",decl:{start:{line:83,column:4},end:{line:83,column:5}},loc:{start:{line:83,column:26},end:{line:97,column:5}},line:83},"5":{name:"(anonymous_5)",decl:{start:{line:104,column:4},end:{line:104,column:5}},loc:{start:{line:104,column:33},end:{line:124,column:5}},line:104},"6":{name:"(anonymous_6)",decl:{start:{line:109,column:38},end:{line:109,column:39}},loc:{start:{line:109,column:45},end:{line:117,column:17}},line:109},"7":{name:"(anonymous_7)",decl:{start:{line:133,column:4},end:{line:133,column:5}},loc:{start:{line:133,column:53},end:{line:150,column:5}},line:133},"8":{name:"(anonymous_8)",decl:{start:{line:152,column:4},end:{line:152,column:5}},loc:{start:{line:152,column:46},end:{line:160,column:5}},line:152},"9":{name:"(anonymous_9)",decl:{start:{line:162,column:4},end:{line:162,column:5}},loc:{start:{line:162,column:44},end:{line:162,column:59}},line:162},"10":{name:"(anonymous_10)",decl:{start:{line:163,column:4},end:{line:163,column:5}},loc:{start:{line:163,column:27},end:{line:163,column:42}},line:163},"11":{name:"(anonymous_11)",decl:{start:{line:165,column:4},end:{line:165,column:5}},loc:{start:{line:165,column:45},end:{line:193,column:5}},line:165},"12":{name:"(anonymous_12)",decl:{start:{line:169,column:22},end:{line:169,column:23}},loc:{start:{line:169,column:36},end:{line:188,column:17}},line:169},"13":{name:"(anonymous_13)",decl:{start:{line:184,column:49},end:{line:184,column:50}},loc:{start:{line:184,column:58},end:{line:187,column:21}},line:184},"14":{name:"(anonymous_14)",decl:{start:{line:189,column:23},end:{line:189,column:24}},loc:{start:{line:189,column:30},end:{line:189,column:50}},line:189},"15":{name:"(anonymous_15)",decl:{start:{line:195,column:4},end:{line:195,column:5}},loc:{start:{line:195,column:22},end:{line:197,column:5}},line:195},"16":{name:"(anonymous_16)",decl:{start:{line:199,column:4},end:{line:199,column:5}},loc:{start:{line:199,column:25},end:{line:201,column:5}},line:199},"17":{name:"(anonymous_17)",decl:{start:{line:203,column:4},end:{line:203,column:5}},loc:{start:{line:203,column:29},end:{line:206,column:5}},line:203},"18":{name:"(anonymous_18)",decl:{start:{line:208,column:4},end:{line:208,column:5}},loc:{start:{line:208,column:17},end:{line:211,column:5}},line:208}},branchMap:{"0":{loc:{start:{line:23,column:12},end:{line:33,column:13}},type:"if",locations:[{start:{line:23,column:12},end:{line:33,column:13}},{start:{line:23,column:12},end:{line:33,column:13}}],line:23},"1":{loc:{start:{line:48,column:26},end:{line:48,column:45}},type:"default-arg",locations:[{start:{line:48,column:41},end:{line:48,column:45}}],line:48},"2":{loc:{start:{line:53,column:12},end:{line:57,column:13}},type:"if",locations:[{start:{line:53,column:12},end:{line:57,column:13}},{start:{line:53,column:12},end:{line:57,column:13}}],line:53},"3":{loc:{start:{line:61,column:12},end:{line:71,column:13}},type:"if",locations:[{start:{line:61,column:12},end:{line:71,column:13}},{start:{line:61,column:12},end:{line:71,column:13}}],line:61},"4":{loc:{start:{line:86,column:12},end:{line:92,column:13}},type:"if",locations:[{start:{line:86,column:12},end:{line:92,column:13}},{start:{line:86,column:12},end:{line:92,column:13}}],line:86},"5":{loc:{start:{line:108,column:12},end:{line:118,column:13}},type:"if",locations:[{start:{line:108,column:12},end:{line:118,column:13}},{start:{line:108,column:12},end:{line:118,column:13}}],line:108},"6":{loc:{start:{line:133,column:33},end:{line:133,column:52}},type:"default-arg",locations:[{start:{line:133,column:48},end:{line:133,column:52}}],line:133},"7":{loc:{start:{line:135,column:12},end:{line:138,column:13}},type:"if",locations:[{start:{line:135,column:12},end:{line:138,column:13}},{start:{line:135,column:12},end:{line:138,column:13}}],line:135},"8":{loc:{start:{line:141,column:12},end:{line:145,column:13}},type:"if",locations:[{start:{line:141,column:12},end:{line:145,column:13}},{start:{line:141,column:12},end:{line:145,column:13}}],line:141},"9":{loc:{start:{line:152,column:26},end:{line:152,column:45}},type:"default-arg",locations:[{start:{line:152,column:41},end:{line:152,column:45}}],line:152},"10":{loc:{start:{line:162,column:25},end:{line:162,column:43}},type:"default-arg",locations:[{start:{line:162,column:39},end:{line:162,column:43}}],line:162},"11":{loc:{start:{line:165,column:29},end:{line:165,column:43}},type:"default-arg",locations:[{start:{line:165,column:39},end:{line:165,column:43}}],line:165},"12":{loc:{start:{line:166,column:8},end:{line:192,column:9}},type:"if",locations:[{start:{line:166,column:8},end:{line:192,column:9}},{start:{line:166,column:8},end:{line:192,column:9}}],line:166},"13":{loc:{start:{line:166,column:11},end:{line:166,column:50}},type:"binary-expr",locations:[{start:{line:166,column:11},end:{line:166,column:27}},{start:{line:166,column:31},end:{line:166,column:50}}],line:166},"14":{loc:{start:{line:172,column:20},end:{line:174,column:21}},type:"if",locations:[{start:{line:172,column:20},end:{line:174,column:21}},{start:{line:172,column:20},end:{line:174,column:21}}],line:172},"15":{loc:{start:{line:176,column:20},end:{line:181,column:21}},type:"if",locations:[{start:{line:176,column:20},end:{line:181,column:21}},{start:{line:176,column:20},end:{line:181,column:21}}],line:176}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0},b:{"0":[0,0],"1":[0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0],"7":[0,0],"8":[0,0],"9":[0],"10":[0],"11":[0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"e42a18b1a872c8a2798a4ee3011b84bbe48b423f"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1vob0z37fp=function(){return actualCoverage;};}return actualCoverage;}cov_1vob0z37fp();// bring in firestore
const Firestore=(cov_1vob0z37fp().s[0]++,require("@google-cloud/firestore/build/src"));class FirestoreDatabaseService{constructor(){cov_1vob0z37fp().f[0]++;cov_1vob0z37fp().s[1]++;this.firestore=new Firestore({projectId:process.env.GOOGLE_CLOUD_PROJECT,keyFilename:process.env.KEY_FILE_NAME});}/**
     * Gets all events and sorts them in descending order (newest to oldest)
     * @returns {Promise<{events: []}>}
     */async getEvents(){cov_1vob0z37fp().f[1]++;const ret=(cov_1vob0z37fp().s[2]++,{events:[]});cov_1vob0z37fp().s[3]++;try{const snapshot=(cov_1vob0z37fp().s[4]++,await this.firestore.collection('Events').orderBy('sortDate','desc').get());cov_1vob0z37fp().s[5]++;if(!snapshot.empty){cov_1vob0z37fp().b[0][0]++;cov_1vob0z37fp().s[6]++;snapshot.docs.forEach(doc=>{cov_1vob0z37fp().f[2]++;// console.log('getEvents - doc: ', doc);
//get data
const event=(cov_1vob0z37fp().s[7]++,doc.data());//get internal firestore id
cov_1vob0z37fp().s[8]++;event.id=doc.id;//add object to array
cov_1vob0z37fp().s[9]++;ret.events.push(event);},this);}else{cov_1vob0z37fp().b[0][1]++;}cov_1vob0z37fp().s[10]++;return ret;}catch(e){cov_1vob0z37fp().s[11]++;console.log('getEvents - Error: ',e.message);cov_1vob0z37fp().s[12]++;throw new Error(`getEvents - Error: ${e.message}`);}}/**
     * Add a new event if the date is not specified today's date is used
     * @param event
     * @param returnEvents
     * @returns {Promise<{date}|*|{events: *[]}>}
     */async addEvent(event,returnEvents=(cov_1vob0z37fp().b[1][0]++,true)){cov_1vob0z37fp().f[3]++;cov_1vob0z37fp().s[13]++;event.likes=0;cov_1vob0z37fp().s[14]++;event.dislikes=0;cov_1vob0z37fp().s[15]++;try{cov_1vob0z37fp().s[16]++;// console.log('empty date: ', event.date);
if(!event.date){cov_1vob0z37fp().b[2][0]++;cov_1vob0z37fp().s[17]++;event.date=this.padDate(new Date().toLocaleString().split(',')[0]);}else{cov_1vob0z37fp().b[2][1]++;cov_1vob0z37fp().s[18]++;event.date=this.padDate(event.date);}cov_1vob0z37fp().s[19]++;event.sortDate=this.createSortDate(event.date);const response=(cov_1vob0z37fp().s[20]++,await this.firestore.collection('Events').add(event));// console.log('addEvent - id: ', response.id);
cov_1vob0z37fp().s[21]++;if(returnEvents){cov_1vob0z37fp().b[3][0]++;cov_1vob0z37fp().s[22]++;try{cov_1vob0z37fp().s[23]++;return await this.getEvents();}catch(e){cov_1vob0z37fp().s[24]++;throw new Error(`addEvent - getEvents - error: ${e.message}`);}}else{cov_1vob0z37fp().b[3][1]++;cov_1vob0z37fp().s[25]++;event.id=response.id;cov_1vob0z37fp().s[26]++;return event;}}catch(e){cov_1vob0z37fp().s[27]++;console.log('addEvent - Error: ',e.message);cov_1vob0z37fp().s[28]++;throw new Error(`addEvent - Error: ${e.message}`);}}/**
     * Get an event by its Unique ID
     * @param id
     * @returns {Promise<{event: null}|{event: FirebaseFirestore.DocumentData}>}
     */async getEventById(id){cov_1vob0z37fp().f[4]++;cov_1vob0z37fp().s[29]++;try{const snapshot=(cov_1vob0z37fp().s[30]++,await this.firestore.collection('Events').doc(id).get());cov_1vob0z37fp().s[31]++;if(!snapshot.empty){cov_1vob0z37fp().b[4][0]++;const doc=(cov_1vob0z37fp().s[32]++,snapshot.data());cov_1vob0z37fp().s[33]++;console.log('getEventById - doc: ',doc);cov_1vob0z37fp().s[34]++;return{event:doc};}else{cov_1vob0z37fp().b[4][1]++;cov_1vob0z37fp().s[35]++;return{event:null};}}catch(e){cov_1vob0z37fp().s[36]++;console.log('Error - getEventById: ',e.message);cov_1vob0z37fp().s[37]++;throw new Error(`getEventById - Error: ${e.message}`);}}/**
     * Get events by title (could be more than one)
     * @param title
     * @returns {Promise<{events: []}>}
     */async getEventsByTitle(title){cov_1vob0z37fp().f[5]++;const ret=(cov_1vob0z37fp().s[38]++,{events:[]});cov_1vob0z37fp().s[39]++;try{const snapshot=(cov_1vob0z37fp().s[40]++,await this.firestore.collection('Events').where('title','==',title).get());cov_1vob0z37fp().s[41]++;if(!snapshot.empty){cov_1vob0z37fp().b[5][0]++;cov_1vob0z37fp().s[42]++;snapshot.docs.forEach(doc=>{cov_1vob0z37fp().f[6]++;// console.log('getEvents - doc: ', doc);
//get data
const event=(cov_1vob0z37fp().s[43]++,doc.data());//get internal firestore id
cov_1vob0z37fp().s[44]++;event.id=doc.id;//add object to array
cov_1vob0z37fp().s[45]++;ret.events.push(event);},this);}else{cov_1vob0z37fp().b[5][1]++;}cov_1vob0z37fp().s[46]++;return ret;}catch(e){cov_1vob0z37fp().s[47]++;console.log('Error - getEventsByTitle: ',e.message);cov_1vob0z37fp().s[48]++;throw new Error(`getEventsByTitle - Error: ${e.message}`);}}/**
     * Updates an event by ID
     * @param id
     * @param event
     * @param returnEvents
     * @returns {Promise<{events: []}>}
     */async updateEvent(id,event,returnEvents=(cov_1vob0z37fp().b[6][0]++,true)){cov_1vob0z37fp().f[7]++;cov_1vob0z37fp().s[49]++;try{cov_1vob0z37fp().s[50]++;if(!!event.date){cov_1vob0z37fp().b[7][0]++;cov_1vob0z37fp().s[51]++;event.date=this.padDate(event.date);cov_1vob0z37fp().s[52]++;event.sortDate=this.createSortDate(event.date);}else{cov_1vob0z37fp().b[7][1]++;}const snapshot=(cov_1vob0z37fp().s[53]++,await this.firestore.collection('Events').doc(id).update(event));cov_1vob0z37fp().s[54]++;console.log('updateEvent - snapshot.docs: ',snapshot);cov_1vob0z37fp().s[55]++;if(returnEvents){cov_1vob0z37fp().b[8][0]++;cov_1vob0z37fp().s[56]++;return this.getEvents();}else{cov_1vob0z37fp().b[8][1]++;cov_1vob0z37fp().s[57]++;return{events:[]};}}catch(e){cov_1vob0z37fp().s[58]++;console.log('Error - updateEvent: ',e.message);cov_1vob0z37fp().s[59]++;throw new Error(`updateEvent - Error: ${e.message}`);}}async deleteEvent(id,returnEvents=(cov_1vob0z37fp().b[9][0]++,true)){cov_1vob0z37fp().f[8]++;cov_1vob0z37fp().s[60]++;try{const snapshot=(cov_1vob0z37fp().s[61]++,await this.firestore.collection('Events').doc(id).delete());cov_1vob0z37fp().s[62]++;console.log('deleteEvent - snapshot.docs: ',snapshot.docs);}catch(e){cov_1vob0z37fp().s[63]++;console.log('Error - deleteEvent: ',e.message);cov_1vob0z37fp().s[64]++;throw new Error(`deleteEvent - Error: ${e.message}`);}}async getEventsCount(includeNull=(cov_1vob0z37fp().b[10][0]++,true)){cov_1vob0z37fp().f[9]++;cov_1vob0z37fp().s[65]++;return null;}async deleteLastEntry(){cov_1vob0z37fp().f[10]++;cov_1vob0z37fp().s[66]++;return null;}changeReaction(id,type,increment=(cov_1vob0z37fp().b[11][0]++,true)){cov_1vob0z37fp().f[11]++;cov_1vob0z37fp().s[67]++;if((cov_1vob0z37fp().b[13][0]++,type==='likes')||(cov_1vob0z37fp().b[13][1]++,type==='dislikes')){cov_1vob0z37fp().b[12][0]++;cov_1vob0z37fp().s[68]++;// return the existing object
this.firestore.collection("Events").doc(id).get().then(snapshot=>{cov_1vob0z37fp().f[12]++;const el=(cov_1vob0z37fp().s[69]++,snapshot.data());// if you have elements in firestore with no likes property
cov_1vob0z37fp().s[70]++;if(!el[type]){cov_1vob0z37fp().b[14][0]++;cov_1vob0z37fp().s[71]++;el[type]=0;}else{cov_1vob0z37fp().b[14][1]++;}// increment the likes
cov_1vob0z37fp().s[72]++;if(increment){cov_1vob0z37fp().b[15][0]++;cov_1vob0z37fp().s[73]++;el[type]++;}else{cov_1vob0z37fp().b[15][1]++;cov_1vob0z37fp().s[74]++;el[type]--;}// do the update
cov_1vob0z37fp().s[75]++;this.firestore.collection("Events").doc(id).update(el).then(ret=>{cov_1vob0z37fp().f[13]++;cov_1vob0z37fp().s[76]++;// return events using shared method that adds __id
return this.getEvents();});}).catch(err=>{cov_1vob0z37fp().f[14]++;cov_1vob0z37fp().s[77]++;console.log(err);});}else{cov_1vob0z37fp().b[12][1]++;cov_1vob0z37fp().s[78]++;return this.getEvents();}}async incLikes(id){cov_1vob0z37fp().f[15]++;cov_1vob0z37fp().s[79]++;return this.changeReaction(id,'likes');}async incDisLikes(id){cov_1vob0z37fp().f[16]++;cov_1vob0z37fp().s[80]++;return this.changeReaction(id,'dislikes');}createSortDate(eventDate){cov_1vob0z37fp().f[17]++;const dateParts=(cov_1vob0z37fp().s[81]++,eventDate.split('/'));cov_1vob0z37fp().s[82]++;return`${dateParts[2]}-${dateParts[0].padStart(2,'0')}-${dateParts[1].padStart(2,'0')}`;}padDate(date){cov_1vob0z37fp().f[18]++;const dateParts=(cov_1vob0z37fp().s[83]++,date.split('/'));cov_1vob0z37fp().s[84]++;return`${dateParts[0].padStart(2,'0')}/${dateParts[1].padStart(2,'0')}/${dateParts[2]}`;}}cov_1vob0z37fp().s[85]++;module.exports=FirestoreDatabaseService;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNsYXNzLmZpcmVzdG9yZS5kYXRhYmFzZS5zZXJ2aWNlLmpzIl0sIm5hbWVzIjpbIkZpcmVzdG9yZSIsInJlcXVpcmUiLCJGaXJlc3RvcmVEYXRhYmFzZVNlcnZpY2UiLCJjb25zdHJ1Y3RvciIsImZpcmVzdG9yZSIsInByb2plY3RJZCIsInByb2Nlc3MiLCJlbnYiLCJHT09HTEVfQ0xPVURfUFJPSkVDVCIsImtleUZpbGVuYW1lIiwiS0VZX0ZJTEVfTkFNRSIsImdldEV2ZW50cyIsInJldCIsImV2ZW50cyIsInNuYXBzaG90IiwiY29sbGVjdGlvbiIsIm9yZGVyQnkiLCJnZXQiLCJlbXB0eSIsImRvY3MiLCJmb3JFYWNoIiwiZG9jIiwiZXZlbnQiLCJkYXRhIiwiaWQiLCJwdXNoIiwiZSIsImNvbnNvbGUiLCJsb2ciLCJtZXNzYWdlIiwiRXJyb3IiLCJhZGRFdmVudCIsInJldHVybkV2ZW50cyIsImxpa2VzIiwiZGlzbGlrZXMiLCJkYXRlIiwicGFkRGF0ZSIsIkRhdGUiLCJ0b0xvY2FsZVN0cmluZyIsInNwbGl0Iiwic29ydERhdGUiLCJjcmVhdGVTb3J0RGF0ZSIsInJlc3BvbnNlIiwiYWRkIiwiZ2V0RXZlbnRCeUlkIiwiZ2V0RXZlbnRzQnlUaXRsZSIsInRpdGxlIiwid2hlcmUiLCJ1cGRhdGVFdmVudCIsInVwZGF0ZSIsImRlbGV0ZUV2ZW50IiwiZGVsZXRlIiwiZ2V0RXZlbnRzQ291bnQiLCJpbmNsdWRlTnVsbCIsImRlbGV0ZUxhc3RFbnRyeSIsImNoYW5nZVJlYWN0aW9uIiwidHlwZSIsImluY3JlbWVudCIsInRoZW4iLCJlbCIsImNhdGNoIiwiZXJyIiwiaW5jTGlrZXMiLCJpbmNEaXNMaWtlcyIsImV2ZW50RGF0ZSIsImRhdGVQYXJ0cyIsInBhZFN0YXJ0IiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IjZrWUFlWTsyRkFmWjtBQUVBLEtBQU1BLENBQUFBLFNBQVMsMEJBQUdDLE9BQU8sQ0FBQyxtQ0FBRCxDQUFWLENBQWYsQ0FF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UyxDQUFDLENBQUQsQ0FBVCxDQUFhQyxRQUFiLENBQXNCLENBQXRCLENBQXlCLEdBQXpCLENBQThCLElBQUdELFNBQVMsQ0FBQyxDQUFELENBQUksRUFBekYsQ0FDSCxDQTlNMEIsQyx5QkFpTi9CRSxNQUFNLENBQUNDLE9BQVAsQ0FBaUJsRSx3QkFBakIiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBicmluZyBpbiBmaXJlc3RvcmVcblxuY29uc3QgRmlyZXN0b3JlID0gcmVxdWlyZShcIkBnb29nbGUtY2xvdWQvZmlyZXN0b3JlL2J1aWxkL3NyY1wiKTtcblxuY2xhc3MgRmlyZXN0b3JlRGF0YWJhc2VTZXJ2aWNlIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5maXJlc3RvcmUgPSBuZXcgRmlyZXN0b3JlKFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHByb2plY3RJZDogcHJvY2Vzcy5lbnYuR09PR0xFX0NMT1VEX1BST0pFQ1QsXG4gICAgICAgICAgICAgICAga2V5RmlsZW5hbWU6IHByb2Nlc3MuZW52LktFWV9GSUxFX05BTUVcbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIGFsbCBldmVudHMgYW5kIHNvcnRzIHRoZW0gaW4gZGVzY2VuZGluZyBvcmRlciAobmV3ZXN0IHRvIG9sZGVzdClcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTx7ZXZlbnRzOiBbXX0+fVxuICAgICAqL1xuICAgIGFzeW5jIGdldEV2ZW50cygpe1xuICAgICAgICBjb25zdCByZXQgPSB7IGV2ZW50czogW10gfTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHNuYXBzaG90ID0gYXdhaXQgdGhpcy5maXJlc3RvcmUuY29sbGVjdGlvbignRXZlbnRzJykub3JkZXJCeSgnc29ydERhdGUnLCAnZGVzYycpLmdldCgpO1xuICAgICAgICAgICAgaWYgKCFzbmFwc2hvdC5lbXB0eSkge1xuICAgICAgICAgICAgICAgIHNuYXBzaG90LmRvY3MuZm9yRWFjaChkb2MgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnZ2V0RXZlbnRzIC0gZG9jOiAnLCBkb2MpO1xuICAgICAgICAgICAgICAgICAgICAvL2dldCBkYXRhXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGV2ZW50ID0gZG9jLmRhdGEoKTtcbiAgICAgICAgICAgICAgICAgICAgLy9nZXQgaW50ZXJuYWwgZmlyZXN0b3JlIGlkXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LmlkID0gZG9jLmlkO1xuICAgICAgICAgICAgICAgICAgICAvL2FkZCBvYmplY3QgdG8gYXJyYXlcbiAgICAgICAgICAgICAgICAgICAgcmV0LmV2ZW50cy5wdXNoKGV2ZW50KTtcbiAgICAgICAgICAgICAgICB9LCB0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdnZXRFdmVudHMgLSBFcnJvcjogJywgZS5tZXNzYWdlKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgZ2V0RXZlbnRzIC0gRXJyb3I6ICR7ZS5tZXNzYWdlfWApO1xuICAgICAgICB9XG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBBZGQgYSBuZXcgZXZlbnQgaWYgdGhlIGRhdGUgaXMgbm90IHNwZWNpZmllZCB0b2RheSdzIGRhdGUgaXMgdXNlZFxuICAgICAqIEBwYXJhbSBldmVudFxuICAgICAqIEBwYXJhbSByZXR1cm5FdmVudHNcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTx7ZGF0ZX18Knx7ZXZlbnRzOiAqW119Pn1cbiAgICAgKi9cbiAgICBhc3luYyBhZGRFdmVudChldmVudCwgcmV0dXJuRXZlbnRzID0gdHJ1ZSl7XG4gICAgICAgIGV2ZW50Lmxpa2VzID0gMDtcbiAgICAgICAgZXZlbnQuZGlzbGlrZXMgPSAwO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ2VtcHR5IGRhdGU6ICcsIGV2ZW50LmRhdGUpO1xuICAgICAgICAgICAgaWYoIWV2ZW50LmRhdGUpIHtcbiAgICAgICAgICAgICAgICBldmVudC5kYXRlID0gdGhpcy5wYWREYXRlKG5ldyBEYXRlKCkudG9Mb2NhbGVTdHJpbmcoKS5zcGxpdCgnLCcpWzBdKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZXZlbnQuZGF0ZSA9IHRoaXMucGFkRGF0ZShldmVudC5kYXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGV2ZW50LnNvcnREYXRlID0gdGhpcy5jcmVhdGVTb3J0RGF0ZShldmVudC5kYXRlKTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5maXJlc3RvcmUuY29sbGVjdGlvbignRXZlbnRzJykuYWRkKGV2ZW50KTtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdhZGRFdmVudCAtIGlkOiAnLCByZXNwb25zZS5pZCk7XG4gICAgICAgICAgICBpZihyZXR1cm5FdmVudHMpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5nZXRFdmVudHMoKTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgYWRkRXZlbnQgLSBnZXRFdmVudHMgLSBlcnJvcjogJHtlLm1lc3NhZ2V9YCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGV2ZW50LmlkID0gcmVzcG9uc2UuaWQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGV2ZW50O1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnYWRkRXZlbnQgLSBFcnJvcjogJywgZS5tZXNzYWdlKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgYWRkRXZlbnQgLSBFcnJvcjogJHtlLm1lc3NhZ2V9YCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgYW4gZXZlbnQgYnkgaXRzIFVuaXF1ZSBJRFxuICAgICAqIEBwYXJhbSBpZFxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPHtldmVudDogbnVsbH18e2V2ZW50OiBGaXJlYmFzZUZpcmVzdG9yZS5Eb2N1bWVudERhdGF9Pn1cbiAgICAgKi9cbiAgICBhc3luYyBnZXRFdmVudEJ5SWQoaWQpe1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3Qgc25hcHNob3QgPSBhd2FpdCB0aGlzLmZpcmVzdG9yZS5jb2xsZWN0aW9uKCdFdmVudHMnKS5kb2MoaWQpLmdldCgpO1xuICAgICAgICAgICAgaWYoIXNuYXBzaG90LmVtcHR5KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZG9jID0gc25hcHNob3QuZGF0YSgpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdnZXRFdmVudEJ5SWQgLSBkb2M6ICcsIGRvYyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtldmVudDogZG9jfTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtldmVudDogbnVsbH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yIC0gZ2V0RXZlbnRCeUlkOiAnLCBlLm1lc3NhZ2UpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBnZXRFdmVudEJ5SWQgLSBFcnJvcjogJHtlLm1lc3NhZ2V9YCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgZXZlbnRzIGJ5IHRpdGxlIChjb3VsZCBiZSBtb3JlIHRoYW4gb25lKVxuICAgICAqIEBwYXJhbSB0aXRsZVxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPHtldmVudHM6IFtdfT59XG4gICAgICovXG4gICAgYXN5bmMgZ2V0RXZlbnRzQnlUaXRsZSh0aXRsZSl7XG4gICAgICAgIGNvbnN0IHJldCA9IHsgZXZlbnRzOiBbXSB9O1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3Qgc25hcHNob3QgPSBhd2FpdCB0aGlzLmZpcmVzdG9yZS5jb2xsZWN0aW9uKCdFdmVudHMnKS53aGVyZSgndGl0bGUnLCAnPT0nLCB0aXRsZSkuZ2V0KCk7XG4gICAgICAgICAgICBpZiAoIXNuYXBzaG90LmVtcHR5KSB7XG4gICAgICAgICAgICAgICAgc25hcHNob3QuZG9jcy5mb3JFYWNoKGRvYyA9PiB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdnZXRFdmVudHMgLSBkb2M6ICcsIGRvYyk7XG4gICAgICAgICAgICAgICAgICAgIC8vZ2V0IGRhdGFcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZXZlbnQgPSBkb2MuZGF0YSgpO1xuICAgICAgICAgICAgICAgICAgICAvL2dldCBpbnRlcm5hbCBmaXJlc3RvcmUgaWRcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQuaWQgPSBkb2MuaWQ7XG4gICAgICAgICAgICAgICAgICAgIC8vYWRkIG9iamVjdCB0byBhcnJheVxuICAgICAgICAgICAgICAgICAgICByZXQuZXZlbnRzLnB1c2goZXZlbnQpO1xuICAgICAgICAgICAgICAgIH0sIHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yIC0gZ2V0RXZlbnRzQnlUaXRsZTogJywgZS5tZXNzYWdlKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgZ2V0RXZlbnRzQnlUaXRsZSAtIEVycm9yOiAke2UubWVzc2FnZX1gKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgYW4gZXZlbnQgYnkgSURcbiAgICAgKiBAcGFyYW0gaWRcbiAgICAgKiBAcGFyYW0gZXZlbnRcbiAgICAgKiBAcGFyYW0gcmV0dXJuRXZlbnRzXG4gICAgICogQHJldHVybnMge1Byb21pc2U8e2V2ZW50czogW119Pn1cbiAgICAgKi9cbiAgICBhc3luYyB1cGRhdGVFdmVudChpZCwgZXZlbnQsIHJldHVybkV2ZW50cyA9IHRydWUpe1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYoISFldmVudC5kYXRlKSB7XG4gICAgICAgICAgICAgICAgZXZlbnQuZGF0ZSA9IHRoaXMucGFkRGF0ZShldmVudC5kYXRlKTtcbiAgICAgICAgICAgICAgICBldmVudC5zb3J0RGF0ZSA9IHRoaXMuY3JlYXRlU29ydERhdGUoZXZlbnQuZGF0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBzbmFwc2hvdCA9IGF3YWl0IHRoaXMuZmlyZXN0b3JlLmNvbGxlY3Rpb24oJ0V2ZW50cycpLmRvYyhpZCkudXBkYXRlKGV2ZW50KTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCd1cGRhdGVFdmVudCAtIHNuYXBzaG90LmRvY3M6ICcsIHNuYXBzaG90KTtcbiAgICAgICAgICAgIGlmKHJldHVybkV2ZW50cykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldEV2ZW50cygpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge2V2ZW50czogW119O1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnRXJyb3IgLSB1cGRhdGVFdmVudDogJywgZS5tZXNzYWdlKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgdXBkYXRlRXZlbnQgLSBFcnJvcjogJHtlLm1lc3NhZ2V9YCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyBkZWxldGVFdmVudChpZCwgcmV0dXJuRXZlbnRzID0gdHJ1ZSl7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBzbmFwc2hvdCA9IGF3YWl0IHRoaXMuZmlyZXN0b3JlLmNvbGxlY3Rpb24oJ0V2ZW50cycpLmRvYyhpZCkuZGVsZXRlKCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnZGVsZXRlRXZlbnQgLSBzbmFwc2hvdC5kb2NzOiAnLCBzbmFwc2hvdC5kb2NzKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yIC0gZGVsZXRlRXZlbnQ6ICcsIGUubWVzc2FnZSk7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYGRlbGV0ZUV2ZW50IC0gRXJyb3I6ICR7ZS5tZXNzYWdlfWApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgZ2V0RXZlbnRzQ291bnQoaW5jbHVkZU51bGwgPSB0cnVlKXsgcmV0dXJuIG51bGw7fVxuICAgIGFzeW5jIGRlbGV0ZUxhc3RFbnRyeSgpeyByZXR1cm4gbnVsbDt9XG5cbiAgICBjaGFuZ2VSZWFjdGlvbihpZCwgdHlwZSwgaW5jcmVtZW50PXRydWUpIHtcbiAgICAgICAgaWYodHlwZSA9PT0gJ2xpa2VzJyB8fCB0eXBlID09PSAnZGlzbGlrZXMnKSB7XG4gICAgICAgICAgICAvLyByZXR1cm4gdGhlIGV4aXN0aW5nIG9iamVjdFxuICAgICAgICAgICAgdGhpcy5maXJlc3RvcmUuY29sbGVjdGlvbihcIkV2ZW50c1wiKS5kb2MoaWQpLmdldCgpXG4gICAgICAgICAgICAgICAgLnRoZW4oKHNuYXBzaG90KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGVsID0gc25hcHNob3QuZGF0YSgpO1xuICAgICAgICAgICAgICAgICAgICAvLyBpZiB5b3UgaGF2ZSBlbGVtZW50cyBpbiBmaXJlc3RvcmUgd2l0aCBubyBsaWtlcyBwcm9wZXJ0eVxuICAgICAgICAgICAgICAgICAgICBpZiAoIWVsW3R5cGVdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbFt0eXBlXSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gaW5jcmVtZW50IHRoZSBsaWtlc1xuICAgICAgICAgICAgICAgICAgICBpZiAoaW5jcmVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbFt0eXBlXSsrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZWxbdHlwZV0tLTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBkbyB0aGUgdXBkYXRlXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlyZXN0b3JlLmNvbGxlY3Rpb24oXCJFdmVudHNcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kb2MoaWQpLnVwZGF0ZShlbCkudGhlbigocmV0KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyByZXR1cm4gZXZlbnRzIHVzaW5nIHNoYXJlZCBtZXRob2QgdGhhdCBhZGRzIF9faWRcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldEV2ZW50cygpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5jYXRjaChlcnIgPT4geyBjb25zb2xlLmxvZyhlcnIpIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RXZlbnRzKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyBpbmNMaWtlcyhpZCl7XG4gICAgICAgIHJldHVybiB0aGlzLmNoYW5nZVJlYWN0aW9uKGlkLCdsaWtlcycpXG4gICAgfVxuXG4gICAgYXN5bmMgaW5jRGlzTGlrZXMoaWQpe1xuICAgICAgICByZXR1cm4gdGhpcy5jaGFuZ2VSZWFjdGlvbihpZCwgJ2Rpc2xpa2VzJyk7XG4gICAgfVxuXG4gICAgY3JlYXRlU29ydERhdGUoZXZlbnREYXRlKXtcbiAgICAgICAgY29uc3QgZGF0ZVBhcnRzID0gZXZlbnREYXRlLnNwbGl0KCcvJyk7XG4gICAgICAgIHJldHVybiBgJHtkYXRlUGFydHNbMl19LSR7ZGF0ZVBhcnRzWzBdLnBhZFN0YXJ0KDIsICcwJyl9LSR7ZGF0ZVBhcnRzWzFdLnBhZFN0YXJ0KDIsICcwJyl9YDtcbiAgICB9XG5cbiAgICBwYWREYXRlKGRhdGUpe1xuICAgICAgICBjb25zdCBkYXRlUGFydHMgPSBkYXRlLnNwbGl0KCcvJyk7XG4gICAgICAgIHJldHVybiBgJHtkYXRlUGFydHNbMF0ucGFkU3RhcnQoMiwgJzAnKX0vJHtkYXRlUGFydHNbMV0ucGFkU3RhcnQoMiwgJzAnKX0vJHtkYXRlUGFydHNbMl19YDtcbiAgICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gRmlyZXN0b3JlRGF0YWJhc2VTZXJ2aWNlO1xuIl19